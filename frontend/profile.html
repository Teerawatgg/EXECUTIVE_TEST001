<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà | Executive</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="css/executive.css" />

  <style>
    body{background:#f6f7fb;}
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:22px;}
    .profile-card{
      width:520px;max-width:100%;
      background:#fff;border:1px solid #eef0f4;border-radius:16px;
      box-shadow:0 10px 30px rgba(17,24,39,.08);
      padding:22px;
    }
    h1{margin:0 0 16px;text-align:center;font-size:20px;font-weight:900;}
    .avatar{
      width:76px;height:76px;border-radius:999px;
      border:3px solid #f97316;
      display:flex;align-items:center;justify-content:center;
      margin:0 auto 14px;
      font-size:28px;
      background:#fff;
    }
    .field{
      background:#f9fafb;border:1px solid #eef0f4;border-radius:12px;
      padding:12px 14px;margin:10px 0;
    }
    .label{font-size:12px;color:#6b7280;font-weight:900;margin-bottom:6px;}
    .value{font-weight:900;color:#111827;}
    .value.orange{color:#f97316;}
    .btnRow{display:flex;gap:12px;margin-top:14px;}
    .btnRow a,.btnRow button{
      flex:1;border-radius:12px;padding:12px 14px;
      font-weight:900;border:none;cursor:pointer;text-decoration:none;
      text-align:center;
    }
    .back{background:#f97316;color:#fff;}
    .logout{background:#ef4444;color:#fff;}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="profile-card">
      <h1>‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</h1>
      <div class="avatar">üë§</div>

      <div class="field">
        <div class="label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</div>
        <div class="value orange" id="pfName">-</div>
      </div>

      <div class="field">
        <div class="label">‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</div>
        <div class="value" id="pfCode">-</div>
      </div>

      <div class="field">
        <div class="label">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</div>
        <div class="value" id="pfRole">-</div>
      </div>

      <div class="field">
        <div class="label">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</div>
        <div class="value" id="pfEmail">-</div>
      </div>

      <div class="btnRow">
        <a class="back" href="index.html">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        <button class="logout" id="pfLogout" type="button">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>
  </div>

  <script>
    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏≤‡∏Å executive/api/me.php (‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)
    async function apiGet(file) {
      const res = await fetch("/sports_rental_system/executive/api/" + file, { credentials: "include" });
      if (!res.ok) return null;
      try { return await res.json(); } catch { return null; }
    }

    function setText(id, v){ const el=document.getElementById(id); if(el) el.textContent = v ?? "-"; }

    document.addEventListener("DOMContentLoaded", async () => {
      const me = await apiGet("me.php");

      // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö (‡∏Å‡∏±‡∏ô key ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á)
      const u = (me && (me.data || me.user || me)) || {};

      setText("pfName",  u.full_name || u.name || "-");
      setText("pfCode",  u.staff_id || u.staff_code || u.code || "-");
      setText("pfRole",  u.role_name || u.role || u.position || "-");
      setText("pfEmail", u.email || "-");

      const btn = document.getElementById("pfLogout");
      btn.addEventListener("click", async () => {
        try { await apiGet("logout.php"); } catch {}
        window.location.href = "login.html";
      });
    });
  </script>
</body>
</html>