<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>โปรไฟล์เจ้าหน้าที่</title>

<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{
  box-sizing:border-box;
  font-family:"Noto Sans Thai",sans-serif;
}

body{
  margin:0;
  background:#f5f6f8;
  display:flex;
  justify-content:center;
  padding:40px 16px;
}

.container{
  width:100%;
  max-width:460px;
}

h2{
  text-align:center;
  margin-bottom:18px;
  font-weight:600;
  font-size:20px;
}

.card{
  background:#fff;
  border-radius:14px;
  padding:22px 20px;
  box-shadow:0 8px 20px rgba(0,0,0,.08);
}

.avatar{
  width:90px;
  height:90px;
  background:#fff3e6;
  border-radius:50%;
  margin:0 auto 20px;
  display:flex;
  align-items:center;
  justify-content:center;
  border:3px solid #ff7a00;
}

.avatar svg{
  width:38px;
  height:38px;
  stroke:#333;
}

.field{
  background:#fafafa;
  border-radius:12px;
  padding:12px 14px;
  margin-bottom:12px;
}

.label{
  font-size:12px;
  color:#777;
  margin-bottom:4px;
}

.value{
  font-size:15px;
  color:#111;
}

.value.highlight{
  color:#ff7a00;
  font-weight:600;
}

.btn-row{
  display:flex;
  gap:10px;
  margin-top:18px;
}

.btn{
  flex:1;
  border:none;
  padding:13px;
  font-size:14px;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
}

.btn-main{
  background:#ff7a00;
  color:white;
}

.btn-logout{
  background:#ef4444;
  color:white;
}

.btn:hover{
  opacity:.9;
}
</style>
</head>

<body>

<div class="container">
  <h2>โปรไฟล์เจ้าหน้าที่</h2>

  <div class="card">

    <div class="avatar">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
        <circle cx="12" cy="8" r="4"></circle>
        <path d="M4 20c0-4 4-6 8-6s8 2 8 6"></path>
      </svg>
    </div>

    <div class="field">
      <div class="label">ชื่อ-นามสกุล</div>
      <div class="value highlight" id="profileName">-</div>
    </div>

    <div class="field">
      <div class="label">รหัสเจ้าหน้าที่</div>
      <div class="value" id="profileId">-</div>
    </div>

    <div class="field">
      <div class="label">ตำแหน่งเจ้าหน้าที่</div>
      <div class="value" id="profileRole">-</div>
    </div>

    <div class="field">
      <div class="label">อีเมล</div>
      <div class="value" id="profileEmail">-</div>
    </div>

    <div class="btn-row">
      <button class="btn btn-main" id="backBtn">
        กลับหน้าหลัก
      </button>

      <button class="btn btn-logout" id="logoutBtn">
        ออกจากระบบ
      </button>
    </div>

  </div>
</div>

<script>
async function apiGet(file){
  const res = await fetch("/sports_rental_system/executive/api/" + file,{
    credentials:"include"
  });

  if(!res.ok) return null;

  try{
    return await res.json();
  }catch{
    return null;
  }
}

document.addEventListener("DOMContentLoaded",async()=>{

  const me = await apiGet("me.php");

  if(!me){
    window.location.href="login.html";
    return;
  }

  const u = me.data || me.user || me;

  document.getElementById("profileName").textContent =
    u.full_name || u.name || "-";

  document.getElementById("profileId").textContent =
    u.staff_id || u.staff_code || "-";

  document.getElementById("profileRole").textContent =
    u.role_name || u.role || u.position || "-";

  document.getElementById("profileEmail").textContent =
    u.email || "-";

});

// buttons
document.getElementById("backBtn").onclick = ()=>{
  window.location.href="index.html";
};

document.getElementById("logoutBtn").onclick = async ()=>{
  try{
    await apiGet("logout.php");
  }catch{}
  window.location.href="login.html";
};
</script>

</body>
</html>