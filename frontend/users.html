<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>Executive | ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/executive.css" />
  <script src="executive-common.js"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <style>
    /* ‚úÖ panel header + print (‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡πÑ‡∏ß‡πâ) */
    .panel-header{
      display:flex; justify-content:space-between; align-items:flex-start;
      gap:12px; margin-bottom:12px;
    }
    .panel-header h3{ margin:0; }
    .print-btn{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 16px; border-radius:999px;
      border:1px solid #dcd6f7; background:#f5f3ff;
      color:#5b21b6; font-weight:600; cursor:pointer;
      transition:.2s ease; white-space:nowrap;
    }
    .print-btn:hover{ background:#ede9fe; transform:translateY(-1px); }
    .print-icon{ font-size:16px; }

    @media print{
      .print-btn, header, .sidebar{ display:none !important; }
      body{ background:#fff; }
      .panel{ box-shadow:none; border:none; }
    }

    /* Dashboard layout */
    .dash{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap:14px;
    }
    .card{
      border:1px solid #eef0f4;
      background:#fff;
      border-radius:14px;
      padding:14px;
      box-shadow:0 10px 26px rgba(17,24,39,.06);
      display:flex; gap:12px; align-items:flex-start;
      min-height:88px;
    }
    .card .ic{
      width:38px; height:38px; border-radius:10px;
      display:flex; align-items:center; justify-content:center;
      background:#f3f4f6;
      font-size:18px;
      flex:0 0 auto;
    }
    .card .t{ font-weight:900; color:#111827; font-size:12px; }
    .card .v{ font-weight:900; color:#111827; font-size:18px; margin-top:4px; }
    .card .s{ font-weight:800; color:#6b7280; font-size:11px; margin-top:2px; }

    .progress{
      margin-top:10px;
      width:100%; height:8px; border-radius:999px;
      background:#eef2f7; overflow:hidden;
    }
    .progress > div{ height:100%; width:0%; background:#22c55e; border-radius:999px; }

    .panel-mini{
      border:1px solid #eef0f4;
      background:#fff;
      border-radius:14px;
      padding:14px;
      box-shadow:0 10px 26px rgba(17,24,39,.06);
    }
    .panel-mini h4{ margin:0 0 10px; font-weight:900; font-size:13px; color:#111827; }
    .panel-mini .muted{ font-weight:800; color:#6b7280; font-size:11px; margin-top:-6px; margin-bottom:10px; }

    .chartBox{ position:relative; height:240px; }
    .chartBox.small{ height:210px; }

    .topList .row{
      display:flex; align-items:center; gap:10px;
      margin:10px 0;
    }
    .topList .rank{
      width:26px; height:26px; border-radius:999px;
      background:#ffedd5; color:#9a3412;
      display:flex; align-items:center; justify-content:center;
      font-weight:900; font-size:12px;
    }
    .topList .name{ font-weight:900; color:#111827; font-size:12px; }
    .topList .bar{
      flex:1;
      height:6px; border-radius:999px; background:#eef2f7; overflow:hidden;
    }
    .topList .bar > div{ height:100%; width:0%; background:#f97316; border-radius:999px; }
    .topList .cnt{ width:64px; text-align:right; font-weight:900; color:#111827; font-size:12px; }

    .seg{
      display:flex; gap:8px;
      justify-content:flex-end;
      margin-top:-6px;
    }
    .seg button{
      border:1px solid #e5e7eb; background:#fff;
      padding:6px 10px; border-radius:999px;
      font-weight:900; cursor:pointer; font-size:12px;
      color:#111827;
    }
    .seg button.active{
      border-color:#22c55e; background:#dcfce7; color:#166534;
    }
  </style>
</head>

<body id="executiveUsers">

  <header class="main-header">
    <div class="header-top">
      <div class="brand">
        <span class="brand-name">‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πà‡∏≤‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏µ‡∏¨‡∏≤</span>
        <small>Sports Equipment Rental System</small>
      </div>
      <div class="staff-zone">
        <a class="pill-btn" href="profile.html">
          <span class="pill-ic">üë§</span> ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
        </a>
      </div>
    </div>

    <div class="header-bottom">
      <nav class="main-nav">
        <a href="index.html" class="nav-item">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</a>
        <a href="users.html" class="nav-item active">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</a>
        <a href="equipment.html" class="nav-item">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</a>
        <a href="equipment-status.html" class="nav-item">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</a>
      </nav>
    </div>
  </header>

  <div class="container">
    <aside class="sidebar">

      <section class="filter-block">
        <h4>‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</h4>
      </section>

      <section class="filter-block">
        <h4>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h4>
        <select id="academicYear" class="time-select"></select>
      </section>

      <section class="filter-block">
        <h4>‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</h4>
        <label><input type="radio" name="range" value="all" checked> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label><br/>
        <label><input type="radio" name="range" value="today"> ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</label><br/>
        <label><input type="radio" name="range" value="7d"> 7 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤</label><br/>
        <label><input type="radio" name="range" value="30d"> 30 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤</label><br/>
        <label><input type="radio" name="range" value="custom"> ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á</label>

        <div id="customDateBox" style="display:none;margin-top:10px;">
          <div style="display:flex;flex-direction:column;gap:8px;">
            <input type="date" id="fromDate" class="time-select" />
            <input type="date" id="toDate" class="time-select" />
          </div>
        </div>
      </section>

      <section class="filter-block">
        <h4>‡∏Ñ‡∏ì‡∏∞</h4>
        <div id="facultyList" style="display:flex;flex-direction:column;gap:6px;"></div>
      </section>

      <section class="filter-block">
        <h4>‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ</h4>
        <div id="studyYearList" style="display:flex;flex-direction:column;gap:6px;"></div>
      </section>

      <section class="filter-block">
        <div class="actions">
          <button class="btn primary" id="btnApply">‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</button>
          <button class="btn" id="btnReset">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
        </div>
      </section>
    </aside>

    <main class="content">
      <section class="panel">

        <div class="panel-header">
          <div>
            <h3>‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</h3>
            <div class="muted">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ì‡∏∞‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</div>
          </div>
          <button class="print-btn" onclick="window.print()">
            <span class="print-icon">üñ®Ô∏è</span> ‡∏û‡∏¥‡∏°‡∏û‡πå
          </button>
        </div>

        <div class="dash">

          <!-- KPI cards -->
          <div class="card" style="grid-column: span 4;">
            <div class="ic">üë•</div>
            <div style="flex:1;">
              <div class="t">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ</div>
              <div class="v" id="kpiTotalUsage">-</div>
              <div class="s">‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
            </div>
          </div>

          <div class="card" style="grid-column: span 4;">
            <div class="ic" style="background:#fff7ed;">üìà</div>
            <div style="flex:1;">
              <div class="t">‡∏Ñ‡∏ì‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</div>
              <div class="v" id="kpiTopFacultyName">-</div>
              <div class="s"><span id="kpiTopFacultyCount">-</span> ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
            </div>
          </div>

          <div class="card" style="grid-column: span 4;">
            <div class="ic" style="background:#ecfdf5;">üìä</div>
            <div style="flex:1;">
              <div class="t">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ</div>
              <div class="v"><span id="kpiUsageRate">-</span>%</div>
              <div class="progress"><div id="kpiUsageBar"></div></div>
            </div>
          </div>

          <!-- Charts row -->
          <div class="panel-mini" style="grid-column: span 6;">
            <h4>‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ì‡∏∞</h4>
            <div class="muted">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á)</div>
            <div class="chartBox"><canvas id="chartFaculty"></canvas></div>
          </div>

          <div class="panel-mini" style="grid-column: span 6;">
            <h4>‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ</h4>
            <div class="muted">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á)</div>
            <div class="chartBox"><canvas id="chartStudyYear"></canvas></div>
          </div>

          <!-- Bottom row -->
          <div class="panel-mini" style="grid-column: span 6;">
            <h4>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏° Top 5</h4>
            <div class="muted">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏¢‡∏∑‡∏°‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á)</div>
            <div class="topList" id="topEquipmentList"></div>
          </div>

          <div class="panel-mini" style="grid-column: span 6;">
            <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:10px;">
              <div>
                <h4 style="margin:0;">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</h4>
                <div class="muted">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡∏π ‚Äú‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‚Äù ‡∏´‡∏£‡∏∑‡∏≠ ‚Äú‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‚Äù</div>
              </div>
              <div class="seg">
                <button id="btnDaily" type="button">‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</button>
                <button id="btnPeak" type="button" class="active">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</button>
              </div>
            </div>
            <div class="chartBox small"><canvas id="chartPeak"></canvas></div>
          </div>

        </div>
      </section>
    </main>
  </div>

  <script src="users.js"></script>
</body>
</html>